<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Giulia - Advanced OBD2 Telemetry</title>
    <link rel="canonical" href="https://my-giulia.com/" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <link rel="stylesheet" href="./src/style.css" />
  </head>

  <body class="spa-mode landing-active docs-body">
    <nav class="top-nav">
      <div class="nav-container">
        <div class="integrated-toolbar">
          <button class="nav-icon-btn" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
          </button>
          <button class="nav-icon-btn" onclick="toggleFullScreen()">
            <i class="fas fa-expand"></i>
          </button>
          <button class="nav-icon-btn info-btn" onclick="toggleInfo()">
            <i class="fas fa-info-circle"></i>
          </button>
        </div>

        <div class="nav-links">
          <div class="nav-divider"></div>
          <a
            href="https://github.com/tzebrowski/ObdGraphs"
            target="_blank"
            class="nav-link"
            title="GitHub"
          >
            <i class="fab fa-github"></i>
          </a>
          <a
            href="https://play.google.com/store/apps/details?id=org.obd.graphs.my.giulia"
            target="_blank"
            class="nav-link"
            title="Google Play"
          >
            <i class="fab fa-google-play"></i>
          </a>

          <a href="index.html" class="nav-btn-primary">
            <i class="fas fa-home" style="margin-right: 8px"></i>
            <span>Back to Home</span>
          </a>
        </div>
      </div>
    </nav>

    <main id="landing-page">
      <section class="hero">
        <h1>My Giulia</h1>
        <p>
          Advanced telemetry and diagnostics for the Alfa Romeo enthusiast.
          Native support for 2.0 GME, 2.2 Multijet, and 2.9 QV engines.
        </p>
        <div
          class="hero-buttons"
          style="display: flex; gap: 15px; justify-content: center"
        >
          <a
            href="#analyzer"
            class="btn-green"
            style="background-color: var(--brand-red)"
          >
            <i class="fas fa-chart-line"></i> Launch Analyzer
          </a>
          <a
            href="https://play.google.com/store/apps/details?id=org.obd.graphs.my.giulia"
            class="btn-green"
          >
            <i class="fab fa-google-play"></i> Download App
          </a>
        </div>
        <div class="video-grid">
          <div class="video-container">
            <iframe
              src="https://www.youtube.com/embed/SJe4QkUgMKs"
              title="My Giulia Telemetry Tutorial"
              allow="
                accelerometer;
                autoplay;
                clipboard-write;
                encrypted-media;
                gyroscope;
                picture-in-picture;
                web-share;
              "
              allowfullscreen
            ></iframe>
          </div>

          <div class="video-container">
            <iframe
              src="https://www.youtube.com/embed/ctQZKFzSG80"
              title="My Giulia Advanced Features"
              allow="
                accelerometer;
                autoplay;
                clipboard-write;
                encrypted-media;
                gyroscope;
                picture-in-picture;
                web-share;
              "
              allowfullscreen
            ></iframe>
          </div>
        </div>
      </section>

      <section class="features">
        <div class="feature-card">
          <i class="fas fa-car-side"></i>
          <h3>Native Vehicle Support</h3>
          <p>
            Advanced telemetry and diagnostics for the Alfa Romeo enthusiast.
            Native support for 2.0 GME, 2.2 Multijet, and 2.9 QV engines.
          </p>
        </div>
        <div class="feature-card">
          <i class="fab fa-google-drive"></i>
          <h3>Cloud Synchronization</h3>
          <p>
            Seamlessly upload your recorded trip logs to Google Drive from the
            mobile app and access them instantly here for advanced analysis.
          </p>
        </div>
        <div class="feature-card">
          <i class="fas fa-mobile-alt"></i>
          <h3>Android Auto Integration</h3>
          <p>
            Dedicated dashboards for performance metrics and trip information
            directly on your car's screen.
          </p>
        </div>
        <div class="feature-card">
          <i class="fas fa-bell"></i>
          <h3>Advanced Alerting</h3>
          <p>
            Set custom upper and lower thresholds for individual metrics to
            monitor engine health in real-time.
          </p>
        </div>
        <div class="feature-card">
          <i class="fas fa-database"></i>
          <h3>Data Logging</h3>
          <p>
            Automatically record trip data and review historical telemetry
            sessions at any time.
          </p>
        </div>
        <div class="feature-card">
          <i class="fas fa-cogs"></i>
          <h3>Configurable Views</h3>
          <p>
            Visualize data through multiple gauge types, including Boost, MAF,
            and Oil Temperature.
          </p>
        </div>
        <div class="feature-card">
          <i class="fas fa-user-circle"></i>
          <h3>Vehicle Profiles</h3>
          <p>
            Create customizable profiles with vehicle-specific settings and
            external PID configurations via JSON.
          </p>
        </div>
      </section>

      <section class="tech-specs">
        <div class="container" style="text-align: center">
          <h2>Hardware & Connectivity</h2>
          <p>
            Compatible with high-performance adapters including ELM327 and
            STN1170/STN2120.
          </p>
          <div class="spec-tags">
            <span class="tag">STNxxx Support</span>
            <span class="tag">ObdMetrics Framework</span>
            <span class="tag">Bluetooth</span>
            <span class="tag">Wi-Fi</span>
            <span class="tag">USB</span>
          </div>
        </div>
      </section>
    </main>

    <main id="analyzer-page" style="display: none">
      <div class="app-container">
        <div class="sidebar" id="sidebar">
          <button
            class="mobile-close-btn"
            onclick="toggleSidebar()"
            aria-label="Close sidebar"
          >
            <i class="fas fa-times"></i>
          </button>

          <h2>My Giulia Telemetry Analyzer</h2>

          <div class="control-group gray-box source-container">
            <h3 class="group-header">Log Source</h3>
            <p class="section-description">
              Load telemetry logs from Google Drive or a local file.
            </p>

            <div class="source-button-grid">
              <button
                id="authBtn"
                class="btn btn-danger"
                onclick="handleAuth()"
                style="flex: 1"
              >
                <i class="fab fa-google-drive" style="font-size: 1.5em"></i>
                <span>Drive Scan</span>
              </button>

              <button
                class="btn btn-secondary"
                onclick="document.getElementById('fileInput').click()"
                style="flex: 1"
              >
                <i class="fas fa-file-upload" style="font-size: 1.5em"></i>
                <span>Local File</span>
              </button>

              <button class="btn" onclick="resetZoom()" style="flex: 1">
                <i class="fas fa-sync-alt" style="font-size: 1.5em"></i>
                <span>Reset</span>
              </button>
            </div>

            <input
              type="file"
              id="fileInput"
              style="display: none"
              accept=".csv,.json,application/json,text/plain"
            />
            <div id="driveList" class="drive-list-modern"></div>
            <div id="fileInfo" class="status-text-subtle"></div>
          </div>

          <div class="control-group gray-box">
            <h3>View Controls</h3>
            <p class="section-description">
              Switch views between Time Chart, XY Plot, and Histogram.
            </p>
            <div class="view-controls-wrapper">
              <button
                id="btn-mode-stack"
                class="view-mode-btn active"
                onclick="toggleViewMode('stack')"
              >
                <i class="fas fa-stream"></i>
                <span>Stacked</span>
              </button>

              <button
                id="btn-mode-overlay"
                class="view-mode-btn"
                onclick="toggleViewMode('overlay')"
              >
                <i class="fas fa-layer-group"></i>
                <span>Overlay</span>
              </button>

              <button
                class="view-mode-btn xy-btn"
                onclick="openXYModal()"
                title="Open Scatter Plot Analysis"
              >
                <i class="fas fa-braille"></i>
                <span>XY</span>
              </button>

              <button
                class="view-mode-btn"
                onclick="histogram_openModal()"
                title="View Histogram"
              >
                <i class="fas fa-chart-bar"></i>
                <span>Hist</span>
              </button>
            </div>
          </div>

          <div class="control-group gray-box">
            <h3 class="group-header">Math Channels</h3>
            <p class="section-description">
              Create virtual sensors using formulas (e.g. Boost, HP).
            </p>

            <div style="padding: 5px 0">
              <button
                id="btn-create-math"
                class="btn btn-secondary"
                onclick="openMathModal()"
                style="width: 100%"
                disabled
              >
                <i class="fas fa-calculator"></i>
                <span>Create New Channel</span>
              </button>
            </div>
          </div>

          <div
            id="projectHistoryContainer"
            class="control-group gray-box"
            style="display: none"
          >
            <div class="group-header-row">
              <h3 id="projectNameDisplay">Project History</h3>
              <button
                class="btn-icon"
                onclick="
                  event.stopPropagation();
                  editProjectName();
                "
                title="Rename Project"
                style="
                  border: none;
                  background: transparent;
                  cursor: pointer;
                  color: #888;
                  padding: 5px;
                "
              >
                <i class="fas fa-pen"></i>
              </button>
            </div>

            <p class="section-description">Timeline of analysis steps.</p>

            <div
              id="projectHistoryList"
              class="history-list"
              style="
                max-height: 150px;
                overflow-y: auto;
                margin-bottom: 10px;
                font-size: 0.85em;
                border: 1px solid #eee;
                background: #fff;
              "
            ></div>

            <div style="display: flex; gap: 5px">
              <button
                id="btnReplayProject"
                class="btn btn-sm btn-primary"
                onclick="replayProjectHistory()"
                style="flex: 1"
              >
                <i class="fas fa-play"></i> Replay All
              </button>
              <button
                class="btn btn-sm"
                onclick="resetProject()"
                title="Clear History"
              >
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </div>

          <div class="control-group gray-box">
            <h3>Anomaly Scanner</h3>
            <p class="section-description">
              Define rules (e.g., Temp > 100) to quickly locate specific events.
            </p>
            <div style="margin-bottom: 10px">
              <select
                id="anomalyTemplate"
                onchange="applyTemplate()"
                class="template-select"
              >
                <option value="">-- Load a Template --</option>
              </select>
            </div>

            <div id="filtersContainer"></div>
            <button class="btn btn-add" onclick="addFilterRow()">
              + Add Condition
            </button>
            <button class="btn btn-primary mt-10" onclick="scanAnomalies()">
              Scan Log
            </button>
            <div id="scanCount" class="result-count"></div>
            <div id="scanResults" class="results-list"></div>
          </div>

          <div class="control-group flex-grow gray-box">
            <div class="group-header-row">
              <h3>Signals</h3>
              <div class="button-row-sm">
                <button class="btn btn-sm" onclick="toggleAllSignals(true)">
                  All
                </button>
                <button class="btn btn-sm" onclick="toggleAllSignals(false)">
                  None
                </button>
              </div>
            </div>
            <p class="section-description">
              Search and select signals to display on the chart.
            </p>
            <div id="signalList" class="signal-list"></div>
          </div>

          <div class="control-group gray-box">
            <h3>Settings & Preferences</h3>
            <p class="section-description">
              Customize the theme, colors, and cloud integration.
            </p>
            <div class="preferences-list">
              <div class="pref-item">
                <div class="pref-info">
                  <span class="pref-title">Dark Mode</span>
                  <span class="pref-desc">Switch to a dark visual theme</span>
                </div>
                <label class="switch">
                  <input type="checkbox" id="pref-theme-dark" />
                  <span class="slider-round"></span>
                </label>
              </div>
              <hr />

              <div class="pref-item">
                <div class="pref-info">
                  <span class="pref-title">Show Area Fills</span>
                  <span class="pref-desc"
                    >Switch to fill area bellow the chart</span
                  >
                </div>
                <label class="switch">
                  <input type="checkbox" id="pref-show-area-fills" />
                  <span class="slider-round"></span>
                </label>
              </div>
              <hr />
              <div class="pref-item">
                <div class="pref-info">
                  <span class="pref-title">Smooth Lines</span>
                  <span class="pref-desc"
                    >Interpolate points for smoother curves</span
                  >
                </div>
                <label class="switch">
                  <input type="checkbox" id="pref-smooth-lines" />
                  <span class="slider-round"></span>
                </label>
              </div>
              <hr />
              <div class="pref-item">
                <div class="pref-info">
                  <span class="pref-title">Color Palette</span>
                  <span class="pref-desc"
                    >Override theme colors with your own</span
                  >
                </div>
                <label class="switch">
                  <input type="checkbox" id="pref-custom-palette" />
                  <span class="slider-round"></span>
                </label>
              </div>

              <hr />
              <div class="pref-subgroup">
                <div class="pref-item">
                  <div class="pref-info">
                    <span class="pref-title">Google Drive Integration</span>
                    <span class="pref-desc">Cloud access configuration</span>
                  </div>
                  <button
                    class="btn btn-sm btn-add"
                    id="toggle-drive-config"
                    onclick="toggleDriveConfig()"
                  >
                    <i class="fas fa-cog"></i> Config
                  </button>
                </div>

                <div
                  id="configPanel"
                  style="
                    display: none;
                    margin-top: 10px;
                    padding: 10px;
                    background: #f0f0f0;
                    border-radius: 4px;
                  "
                >
                  <input
                    type="text"
                    id="gClientId"
                    placeholder="Enter Google Client ID"
                    style="margin-bottom: 8px"
                  />
                  <button
                    class="btn btn-primary btn-sm"
                    onclick="saveDriveConfig()"
                  >
                    Save ID
                  </button>
                </div>
              </div>

              <hr />
              <div class="pref-item">
                <div class="pref-info">
                  <span class="pref-title">Remember Layout</span>
                  <span class="pref-desc">Persist collapsed sections</span>
                </div>
                <label class="switch">
                  <input type="checkbox" id="pref-persistence" checked />
                  <span class="slider-round"></span>
                </label>
              </div>

              <div class="pref-item">
                <div class="pref-info">
                  <span class="pref-title">High Performance</span>
                  <span class="pref-desc">Reduce chart rendering overhead</span>
                </div>
                <label class="switch">
                  <input type="checkbox" id="pref-performance" />
                  <span class="slider-round"></span>
                </label>
              </div>
            </div>
          </div>
        </div>

        <div id="resizer" class="resizer"></div>

        <div class="main-content" id="mainContent">
          <div id="chartContainer">
            <div id="empty-state" class="empty-state-container">
              <div class="empty-state-content">
                <i class="fas fa-chart-area empty-icon"></i>
                <h3>No Telemetry Loaded</h3>
                <p>
                  Start by scanning your Google Drive or uploading a local JSON
                  trip log.
                </p>
                <div class="empty-state-actions">
                  <button
                    class="btn btn-primary mobile-only-btn"
                    onclick="toggleSidebar()"
                  >
                    <i class="fas fa-folder-open"></i> Open Log Source
                  </button>
                  <button class="btn" onclick="loadSampleData(false)">
                    <i class="fas fa-vial"></i> Load Sample Trip
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div
            id="mapContainer"
            style="
              height: 300px;
              width: 100%;
              display: none;
              margin-top: 20px;
              border: 1px solid #ccc;
            "
          ></div>

          <div id="dropZone" class="drop-zone">
            <div class="drop-zone-content">
              <i class="fas fa-file-upload"></i>
              <p>Drag & Drop telemetry JSON here or <span>browse</span></p>
              <input type="file" id="fileInputDropZone" accept=".json" hidden />
            </div>
          </div>
        </div>
      </div>

      <div id="loadingOverlay" class="loading-overlay" style="display: none">
        <div class="spinner"></div>
        <div id="loadingText">Loading...</div>
        <button id="cancelLoadBtn" class="btn">Cancel</button>
      </div>

      <div id="infoModal" class="modal-overlay" style="display: none">
        <div class="modal-content">
          <div class="modal-header">
            <h2>Application Overview</h2>
            <button class="btn-close" onclick="toggleInfo()">√ó</button>
          </div>
          <div class="modal-body">
            <p class="app-description">
              <strong>My Giulia Telemetry Analyzer:</strong> A professional tool
              for visualizing and scanning vehicle OBD data. Compare multiple
              logs, sync timelines, and detect mechanical anomalies
              automatically.
            </p>

            <div class="info-grid">
              <div
                class="info-card data-source-card"
                style="grid-column: span 2"
              >
                <h4>üì± Data Source</h4>
                <div class="data-source-flex">
                  <img
                    src="https://lh3.googleusercontent.com/d_S-jY_V_7z9_x_W5y_6z5z6z5z6z5z6z5z6z5z6z5z6z5z6z5z6z5z6z5z6z5z6=s128"
                    alt="MyGiulia Logo"
                    class="app-icon"
                    onerror="
                      this.src =
                        'https://img.icons8.com/color/96/google-play.png'
                    "
                  />
                  <div class="data-source-text">
                    <p>
                      Telemetry data is collected by the
                      <strong>MyGiulia</strong> Android application.
                    </p>
                    <a
                      href="https://play.google.com/store/apps/details?id=org.obd.graphs.my.giulia"
                      target="_blank"
                      class="play-store-btn"
                    >
                      <img
                        src="https://upload.wikimedia.org/wikipedia/commons/7/78/Google_Play_Store_badge_EN.svg"
                        alt="Get it on Google Play"
                        height="30"
                      />
                    </a>
                  </div>
                </div>
              </div>

              <div class="info-card" style="grid-column: span 2">
                <h4>üì• How to Import Logs</h4>
                <ol class="import-steps">
                  <li>
                    Open <strong>MyGiulia</strong> on your Android device.
                  </li>
                  <li>
                    Navigate to the <strong>Graph</strong> view and select
                    <strong>Manage recorded trips</strong>.
                  </li>
                  <li>
                    Select your log and tap <strong>Send to Cloud</strong>.
                  </li>
                  <li>
                    Upload the file here using the
                    <strong>"Upload Log"</strong> button.
                  </li>
                </ol>
                <div class="sample-data-box">
                  <p>No log files handy? Try this real-world trip profile:</p>
                  <button class="btn btn-sample" onclick="loadSampleData(true)">
                    üìÇ Load Sample Trip (JSON)
                  </button>
                </div>
              </div>

              <div class="info-card">
                <h4>‚å®Ô∏è Keyboard Shortcuts</h4>
                <ul
                  style="
                    list-style: none;
                    padding-left: 0;
                    font-size: 0.85em;
                    color: #555;
                  "
                >
                  <li><strong>A</strong> - Add Annotation at cursor</li>
                  <li><strong>E</strong> - Export visible area to CSV</li>
                  <li><strong>L</strong> - Toggle Floating Legend</li>
                  <li>
                    <strong>Arrows</strong> - Pan Left/Right (Shift for faster)
                  </li>
                  <li><strong>+ / -</strong> - Zoom In / Out</li>
                  <li><strong>R</strong> - Reset View</li>
                </ul>
              </div>

              <div class="info-card">
                <h4>üîç Anomaly Scanning</h4>
                <p>
                  Uses logic templates to pinpoint events like boost leaks with
                  contextual zoom.
                </p>
              </div>

              <div class="info-card">
                <h4>üîÑ Multi-Sync</h4>
                <p>
                  Pan or zoom on any chart to automatically align all loaded
                  logs.
                </p>
              </div>

              <div class="info-card">
                <h4>üìö Technical Guides</h4>
                <p style="margin-bottom: 10px; font-size: 0.9em; color: #666">
                  Deep dive into engine parameters.
                </p>
                <a
                  href="help_spark.html"
                  target="_blank"
                  class="btn-secondary"
                  style="
                    display: inline-block;
                    text-decoration: none;
                    padding: 6px 12px;
                    font-size: 0.9em;
                    border-radius: 4px;
                    width: 100%;
                    text-align: center;
                  "
                >
                  <i
                    class="fas fa-bolt"
                    style="color: #ffc107; margin-right: 5px"
                  ></i>
                  Spark Advance Guide
                </a>
              </div>
            </div>

            <div class="modal-footer">
              <div class="modal-preferences">
                <label class="custom-checkbox-container">
                  <input type="checkbox" id="hideInfoCheckbox" />
                  <span class="checkmark"></span>
                  <span class="label-text">Don't show this again</span>
                </label>
                <button id="closeInfoBtn" class="btn btn-primary">
                  Got it!
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="customAlert" class="modal-overlay" style="display: none">
        <div class="modal-content alert-modal">
          <div class="modal-header alert-header">
            <h2 id="alertTitle">Notification</h2>
            <button class="btn-close" onclick="hideAlert()">√ó</button>
          </div>
          <div class="modal-body">
            <p id="alertMessage"></p>
          </div>
          <div class="modal-footer">
            <button class="btn btn-primary" onclick="hideAlert()">OK</button>
          </div>
        </div>
      </div>

      <div id="xyModal" class="modal-overlay" style="display: none">
        <div
          class="modal-content"
          style="
            width: 95vw;
            height: 95vh;
            display: flex;
            flex-direction: column;
          "
        >
          <div class="modal-header">
            <h2>XY Scatter Analysis</h2>
            <button class="btn-close" onclick="closeXYModal()">√ó</button>
          </div>

          <div
            class="modal-body"
            style="
              display: flex;
              flex-direction: column;
              flex: 1;
              overflow: hidden;
              padding: 0;
            "
          >
            <div
              style="
                padding: 10px;
                border-bottom: 1px solid #ddd;
                background: #f8f9fa;
                display: flex;
                gap: 10px;
                align-items: center;
              "
            >
              <label style="font-weight: bold; color: #555">Log File:</label>
              <select
                id="xyGlobalFile"
                class="template-select"
                style="max-width: 300px"
                onchange="onFileChange()"
              ></select>
              <button class="btn" style="width: auto" onclick="resetAllZooms()">
                <i class="fas fa-compress-arrows-alt"></i> Reset All
              </button>
            </div>

            <div
              id="xySplitView"
              style="
                display: flex;
                flex: 2;
                min-height: 0;
                border-bottom: 2px solid #ccc;
              "
            >
              <div
                class="xy-panel"
                style="
                  flex: 1;
                  display: flex;
                  flex-direction: column;
                  border-right: 1px solid #ddd;
                  padding: 10px;
                  min-width: 0;
                "
              >
                <div
                  class="xy-panel-toolbar"
                  style="
                    display: flex;
                    gap: 5px;
                    margin-bottom: 10px;
                    align-items: center;
                  "
                >
                  <div style="flex: 1; min-width: 0">
                    <div style="font-size: 0.7em; color: #666">X Axis</div>
                    <select
                      id="xyX-0"
                      class="template-select"
                      style="width: 100%"
                    ></select>
                  </div>
                  <div style="flex: 1; min-width: 0">
                    <div style="font-size: 0.7em; color: #666">Y Axis</div>
                    <select
                      id="xyY-0"
                      class="template-select"
                      style="width: 100%"
                    ></select>
                  </div>
                  <div style="flex: 1; min-width: 0">
                    <div style="font-size: 0.7em; color: #666">
                      Z Axis (Color)
                    </div>
                    <select
                      id="xyZ-0"
                      class="template-select"
                      style="width: 100%"
                    ></select>
                  </div>
                  <button
                    class="btn btn-primary"
                    style="width: auto; height: 32px; align-self: flex-end"
                    onclick="plot(0)"
                  >
                    Plot
                  </button>
                </div>
                <div
                  style="
                    flex: 1;
                    position: relative;
                    min-height: 0;
                    display: flex;
                  "
                >
                  <div style="flex: 1; position: relative">
                    <canvas id="xyCanvas-0"></canvas>
                  </div>
                  <div
                    id="xyLegend-0"
                    class="xy-legend-strip"
                    style="display: none"
                  ></div>
                </div>
              </div>

              <div
                class="xy-panel"
                style="
                  flex: 1;
                  display: flex;
                  flex-direction: column;
                  padding: 10px;
                  min-width: 0;
                "
              >
                <div
                  class="xy-panel-toolbar"
                  style="
                    display: flex;
                    gap: 5px;
                    margin-bottom: 10px;
                    align-items: center;
                  "
                >
                  <div style="flex: 1; min-width: 0">
                    <div style="font-size: 0.7em; color: #666">X Axis</div>
                    <select
                      id="xyX-1"
                      class="template-select"
                      style="width: 100%"
                    ></select>
                  </div>
                  <div style="flex: 1; min-width: 0">
                    <div style="font-size: 0.7em; color: #666">Y Axis</div>
                    <select
                      id="xyY-1"
                      class="template-select"
                      style="width: 100%"
                    ></select>
                  </div>
                  <div style="flex: 1; min-width: 0">
                    <div style="font-size: 0.7em; color: #666">
                      Z Axis (Color)
                    </div>
                    <select
                      id="xyZ-1"
                      class="template-select"
                      style="width: 100%"
                    ></select>
                  </div>
                  <button
                    class="btn btn-primary"
                    style="width: auto; height: 32px; align-self: flex-end"
                    onclick="plot(1)"
                  >
                    Plot
                  </button>
                </div>
                <div
                  style="
                    flex: 1;
                    position: relative;
                    min-height: 0;
                    display: flex;
                  "
                >
                  <div style="flex: 1; position: relative">
                    <canvas id="xyCanvas-1"></canvas>
                  </div>
                  <div
                    id="xyLegend-1"
                    class="xy-legend-strip"
                    style="display: none"
                  ></div>
                </div>
              </div>
            </div>

            <div
              id="xyTimelineView"
              style="
                display: flex;
                flex: 1;
                min-height: 0;
                flex-direction: column;
                padding: 5px;
                background: #fafafa;
              "
            >
              <div
                style="
                  font-size: 0.8em;
                  font-weight: bold;
                  color: #555;
                  margin-bottom: 5px;
                  padding-left: 5px;
                "
              >
                <i class="fas fa-clock"></i> Timeline Reference (Active Signals)
              </div>
              <div style="flex: 1; position: relative; min-height: 0">
                <canvas id="xyTimelineCanvas"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div id="mathModal" class="modal-overlay" style="display: none">
        <div class="modal-content">
          <div class="modal-header">
            <h2>Create Math Channel</h2>
            <button class="btn-close" onclick="closeMathModal()">√ó</button>
          </div>
          <div class="modal-body">
            <div class="control-group">
              <label>Select Formula:</label>
              <select
                id="mathFormulaSelect"
                class="template-select"
                onchange="onMathFormulaChange()"
              ></select>
            </div>

            <div
              id="mathDescriptionContainer"
              style="
                margin-top: 10px;
                padding: 10px;
                background: #f1f3f5;
                border-left: 4px solid #1c3d72;
                border-radius: 4px;
                display: none; /* Ukryte domy≈õlnie */
              "
            >
              <p
                id="mathFormulaDescription"
                style="
                  margin: 0;
                  font-size: 0.9em;
                  line-height: 1.4;
                  color: #495057;
                "
              ></p>
            </div>

            <div
              id="mathInputsContainer"
              style="
                margin-top: 15px;
                display: flex;
                flex-direction: column;
                gap: 10px;
              "
            ></div>

            <div
              id="mathNameContainer"
              class="control-group"
              style="
                margin-top: 15px;
                border-top: 1px solid #eee;
                padding-top: 15px;
                display: none;
              "
            >
              <label>New Channel Name:</label>
              <input
                type="text"
                id="mathChannelName"
                placeholder="e.g. My Boost Pressure"
                style="
                  width: 100%;
                  padding: 8px;
                  box-sizing: border-box;
                  border: 1px solid #ddd;
                  border-radius: 4px;
                "
              />
            </div>
          </div>

          <div
            class="modal-footer"
            style="padding: 15px; text-align: right; border-top: 1px solid #eee"
          >
            <button
              id="btnCreate"
              class="btn btn-primary"
              onclick="createMathChannel()"
            >
              Create Channel
            </button>
          </div>
        </div>
      </div>
    </main>

    <div class="footer">
      <p>
        ¬© 2026 Tomasz ≈ªebrowski. All rights reserved.<br />
        <em
          >MyGiulia is an independent project and is not affiliated with any
          vehicle manufacturer.</em
        >
      </p>
      <div
        class="footer-links"
        style="
          margin-top: 10px;
          display: flex;
          justify-content: center;
          gap: 20px;
        "
      >
        <a href="policy.html" style="font-size: 1.1em"
          ><i class="fas fa-shield-alt"></i> Privacy Policy</a
        >
        <span id="appVersion" class="app-version-container"></span>
      </div>
    </div>

    <script type="module" src="./src/config.js"></script>
    <script type="module" src="./src/alert.js"></script>
    <script type="module" src="./src/auth.js"></script>
    <script type="module" src="./src/drive.js"></script>
    <script type="module" src="./src/chartmanager.js"></script>
    <script type="module" src="./src/ui.js"></script>
    <script type="module" src="./src/analysis.js"></script>
    <script type="module" src="./src/dataprocessor.js"></script>
    <script type="module" src="./src/entry.js"></script>
    <script type="module" src="./src/debounce.js"></script>
    <script type="module" src="./src/xyanalysis.js"></script>
    <script type="module" src="./src/bus.js"></script>
    <script type="module" src="./src/navigation.js"></script>
    <script type="module" src="./src/mathchannels.js"></script>
    <script type="module" src="./src/projectmanager.js"></script>
  </body>
</html>
